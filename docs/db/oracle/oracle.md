### mysql&oracle对比

|     **维度**     |      **MySQL 单进程**      |      **Oracle 单实例**       |         **Oracle RAC 集群**          |
| :--------------: | :------------------------: | :--------------------------: | :----------------------------------: |
|  **数据库数量**  |    可创建多个逻辑数据库    |   只能管理 1 个物理数据库    |     多个实例共享 1 个物理数据库      |
| **物理文件隔离** | 各逻辑数据库有独立数据目录 | 整个数据库的物理文件统一管理 |      所有实例共享同一套物理文件      |
|   **资源分配**   |   所有数据库共享进程资源   |    单个数据库独占实例资源    |        多个实例分摊数据库资源        |
|   **隔离级别**   |    逻辑隔离（权限控制）    | 物理隔离（实例级）或逻辑隔离 |     物理隔离（实例级）但数据共享     |
|   **典型场景**   | 企业多业务线共用数据库服务 |     单业务系统独立数据库     | 高可用、高并发核心系统（如银行交易） |

### 重置sys用户密码

#### 1. 备份原密码文件

Oracle 的密码文件存储了拥有`SYSDBA`和`SYSOPER`权限用户的密码信息，默认路径在 Oracle 安装目录下的`database`文件夹中，文件名为`PWD<sid>.ora`（`<sid>`代表数据库实例名 ，比如你的实例名为`ORCL`，则密码文件可能是`PWDORCL.ora`）。
将该密码文件复制到其他安全的位置进行备份，防止后续操作失误导致文件不可用。例如，你可以把它复制到`D:\oracle_backup\`文件夹下，并重命名为`PWDORCL_bak.ora` 。

#### 2. 使用 orapwd 工具修改密码文件

以管理员身份打开命令提示符（在 Windows 搜索框中输入 “cmd”，右键点击 “命令提示符”，选择 “以管理员身份运行”）。
进入到 Oracle 安装目录下的`bin`文件夹（例如`C:\oracle\product\19.0.0\dbhome_1\bin`，请根据实际安装路径调整）。
执行以下命令来生成新的密码文件：

```plaintext
orapwd FILE=C:\oracle\product\19.0.0\dbhome_1\database\PWD<sid>.ora PASSWORD=新密码 FORCE=Y
```

- `FILE`：指定密码文件的路径和名称，要确保路径和文件名与原密码文件一致（`<sid>`需替换为实际的数据库实例名）。
- `PASSWORD`：设置`sys`用户的新密码，新密码要满足 Oracle 的密码复杂度要求，比如至少 8 位，包含大写字母、小写字母、数字和特殊字符等。
- `FORCE=Y`：表示如果指定路径下已经存在密码文件，会强制覆盖它。

#### 3. 验证新密码

打开命令提示符，输入`sqlplus SYS/新密码 AS SYSDBA` ，尝试使用新设置的密码以`SYSDBA`身份登录数据库。如果登录成功，说明密码重置操作完成；如果登录失败，需要仔细检查前面的操作步骤，或者查看数据库的相关日志文件（比如 Oracle 安装目录下的`log`文件夹中的日志）来排查问题。

需要注意的是，`orapwd`工具主要用于管理拥有`SYSDBA`和`SYSOPER`权限的用户密码，并且在操作过程中要谨慎，避免因误操作影响数据库的正常运行。

### 服务端登录sys用户

命令行中，正确的 `sys` 用户登录语法，需指定 `SYSDBA` 身份，格式如下：

```plaintext
sqlplus sys/密码@数据库连接串 as sysdba
```

 比如知道密码为 `yourpassword` ，数据库连接串为 `orcl` ，则命令为 `sqlplus sys/yourpassword@orcl as sysdba` 。

### sys用户生成awr报告

#### txt格式

Oracle 提供了脚本`awrrpt.sql`来生成文本格式的 AWR 报告。在`SQL>`提示符下，执行以下命令：

```sql
@?/rdbms/admin/awrrpt.sql
```

执行上述命令后，SQL*Plus 会依次提示你输入以下内容：

- **输入要生成报告的数据库的 DBID**：一般直接按回车键，让系统自动获取当前数据库的 DBID 。
- **输入要生成报告的实例号**：如果是单实例数据库，直接按回车键使用默认值；如果是 RAC（Real Application Cluster，实时应用集群）环境，选择对应的实例号。
- **输入报告的起始快照的编号**：输入前面查询得到的`begin_snap_id` 。
- **输入报告的结束快照的编号**：输入前面查询得到的`end_snap_id` 。
- **输入要生成的报告文件名**：可以直接按回车键使用默认文件名，也可以输入自定义的文件名（包含路径，如`D:\awr\my_awr_report.txt` ）。

完成上述输入后，SQL*Plus 会自动生成并显示 AWR 报告内容，同时也会将报告保存到指定的文件中（若指定了自定义文件名）。

#### html格式

Oracle 提供了脚本`awrrpti.sql`来生成 HTML 格式的 AWR 报告。在`SQL>`提示符下，执行以下命令：

```sql
@?/rdbms/admin/awrrpti.sql
```

执行该命令后，SQL*Plus 同样会依次提示你输入数据库的 DBID、实例号、起始快照编号、结束快照编号 ，操作方式与生成文本格式报告时类似。最后也会提示你输入报告文件名，你可以按回车键使用默认文件名，或者输入自定义的文件名（包含路径，如`D:\awr\my_awr_report.html` ）。

完成输入后，SQL*Plus 会生成 HTML 格式的 AWR 报告，并将其保存到指定文件，你可以使用浏览器打开该文件查看报告内容。

### 客户端sqlplus登录



### oracle生成快照与验证

#### 1.调用包过程生成快照

执行`DBMS_WORKLOAD_REPOSITORY.CREATE_SNAPSHOT`过程来创建快照，示例代码如下：

```sql
BEGIN
  DBMS_WORKLOAD_REPOSITORY.CREATE_SNAPSHOT;
END;
/
```

执行上述代码后，数据库就会生成一个新的 AWR 快照 。

#### 2. 验证快照生成

可以通过查询`dba_hist_snapshot`视图来验证快照是否生成成功，示例查询语句：

```sql
SELECT snap_id, snap_time
FROM dba_hist_snapshot
ORDER BY snap_id DESC;
```

上述查询会按照快照 ID 降序显示快照信息，包括快照 ID 和快照生成时间，以确认新的快照已成功创建。